---
title: "Descriptive Statistics"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Load packages
```{r load tidyverse and hmisc, message = FALSE}
library(tidyverse)
library(Hmisc) # install.packages("Hmisc")
library(MBESS)
```

Load in data.

```{r load in data, message = FALSE, warning = FALSE}
sad_data <- read_csv("total_data.csv")
```

Retain only those variables required to match the correlation matrix in the original manuscript.

```{r filter variables of dataset}
var_int <- c("anticipating", "savoring_moment", "reminiscing", "masq_pa", "masq_na", "masq_aa", "phq_total", "pswq_total")
sad_data_int <- sad_data %>% 
  select(var_int)
```

Create correlation matrix.

```{r correlation matrix}
# data frame must be converted to matrix type for function to work.
rcorr(as.matrix(sad_data_int))
# for additional decimals
cor(as.matrix(sad_data_int))
```

```{r create empty data frame for descriptive statistics}
dep_group <- tibble("Depression Group" = c("Minimal", "Mild", "Moderate", "Moderately Severe", "Severe"),
                    "n" = NA,
                    "%" = NA,
                    "PA Mean" = NA,
                    "PA SD" = NA,
                    "PA $\\\\omega$" = NA,
                    "NA Mean" = NA,
                    "NA SD" = NA,
                    "NA $\\\\omega$" = NA,
                    "StM Mean" = NA,
                    "StM SD" = NA,
                    "Stm $\\\\omega$" = NA
                    )
```

```{r create severity designation variable based on descriptors from Kroenke et al., 2001}
sad_data_severity <- sad_data %>% 
  mutate("severity" = if_else(phq_total > 20, "Severe", 
                              if_else(phq_total > 15, "Moderately Severe",
                                      if_else(phq_total > 10, "Moderate",
                                              if_else(between(phq_total, 5, 9), "Mild", "a_Minimal")
                                             )
                                      )
                              )
         )
```

```{r create data frame for n, percent, mean, and sd for each variable}
n <- sad_data_severity %>%
  split(.$severity) %>% 
  map_dbl(~ {
    nrow(.x)
    })

percent <- sad_data_severity %>%
  split(.$severity) %>% 
  map_dbl(~ {
    "n" = round(nrow(.x) / nrow(sad_data_severity) * 100, digits = 2)
    })

mean_pa <- sad_data_severity %>% 
  split(.$severity) %>% 
  map_df(~ {
    round(mean(.x$masq_pa), digits = 2)
  })

sd_pa <- sad_data_severity %>% 
  split(.$severity) %>% 
  map_df(~ { 
    round(sd(.x$masq_pa), digits = 2)
    })

mean_na <- sad_data_severity %>% 
  split(.$severity) %>% 
  map_df(~ {
    round(mean(.x$masq_na), digits = 2)
  })

sd_na <- sad_data_severity %>% 
  split(.$severity) %>% 
  map_df(~ { 
    round(sd(.x$masq_na), digits = 2)
    })

mean_stm <- sad_data_severity %>% 
  split(.$severity) %>% 
  map_df(~ {
    round(mean(.x$savoring_moment), digits = 2)
  })

sd_stm <- sad_data_severity %>% 
  split(.$severity) %>% 
  map_df(~ { 
    round(sd(.x$savoring_moment), digits = 2)
    })
```

```{r now derive macdonald's omega for each partitioned group}
# derive Macdonald's Omega for each subscale
pa_items <- c("masq_2", "masq_4", "masq_5", "masq_7", "masq_11", "masq_14", "masq_19", "masq_23", "masq_26", "masq_28", "masq_32", "masq_34", "masq_36", "masq_37")
na_items <- c("masq_9", "masq_13", "masq_17", "masq_21", "masq_29", "masq_30", "masq_35", "masq_38")
moment_items <- c("sbi_5", "sbi_11", "sbi_17", "sbi_23", "sbi_2_r", "sbi_8_r", "sbi_14_r", "sbi_20_r")

min_mom_omega <- sad_data_severity %>%
  filter(severity == "a_Minimal") %>%
  select(moment_items) %>% 
  ci.reliability(., type = "omega")

mild_mom_omega <- sad_data_severity %>% 
  filter(severity == "Mild") %>% 
  select(moment_items) %>% 
  ci.reliability(., type = "omega")

map(items, ~{
  ci.reliability(.x, type = "omega")
})
```

