---
title: "Descriptive Statistics"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Load packages
```{r load tidyverse and hmisc, message = FALSE}
library(tidyverse)
library(Hmisc) # install.packages("Hmisc")
library(MBESS)
```

Load in data.

```{r load in data, message = FALSE, warning = FALSE}
sad_data <- read_csv("total_data.csv")
```

Retain only those variables required to match the correlation matrix in the original manuscript.

```{r filter variables of dataset}
var_int <- c("anticipating", "savoring_moment", "reminiscing", "masq_pa", "masq_na", "masq_aa", "phq_total", "pswq_total")
sad_data_int <- sad_data %>% 
  select(var_int)
```

Create correlation matrix.

```{r correlation matrix}
# data frame must be converted to matrix type for function to work.
rcorr(as.matrix(sad_data_int))
# for additional decimals
cor(as.matrix(sad_data_int))
```

```{r create empty data frame for descriptive statistics}
dep_group <- tibble("Depression Group" = c("Minimal", "Mild", "Moderate", "Moderately Severe", "Severe"),
                    "n" = NA,
                    "%" = NA,
                    "PA Mean" = NA,
                    "PA SD" = NA,
                    "PA $\\\\omega$" = NA,
                    "NA Mean" = NA,
                    "NA SD" = NA,
                    "NA $\\\\omega$" = NA,
                    "StM Mean" = NA,
                    "StM SD" = NA,
                    "Stm $\\\\omega$" = NA
                    )
```

```{r create severity designation variable based on descriptors from Kroenke et al., 2001}
sad_data_severity <- sad_data_int %>% 
  mutate("severity" = if_else(phq_total > 20, "Severe", 
                              if_else(phq_total > 15, "Moderately Severe",
                                      if_else(phq_total > 10, "Moderate",
                                              if_else(between(phq_total, 5, 9), "Mild", "a_Minimal")
                                             )
                                      )
                              )
         )

sad_data_severity %>%
  split(.$severity) %>% 
  map_dbl(~ {
    nrow(.x)
    })

sad_data_severity %>%
  split(.$severity) %>% 
  map_dbl(~ {
    round(nrow(.x) / nrow(sad_data_severity) * 100, digits = 2)
    })

sad_data_severity %>% 
  split(.$severity) %>% 
  map_df(~ {
    mean(.x$masq_pa)
  })

invoke_map(list(nrow, mean, sd), 
```

